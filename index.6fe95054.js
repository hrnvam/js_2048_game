var t={};class e{static gameStatus={idle:"idle",playing:"playing",win:"win",lose:"lose"};constructor(t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]){this.status=e.gameStatus.idle,this.score=0,this.initialState=t,this.state=t.map(t=>[...t])}moveLeft(){if(this.getStatus()!==e.gameStatus.playing)return;let t=!1;for(let e=0;e<this.state.length;e++){let s=this.state[e].filter(t=>0!==t);for(let e=0;e<s.length-1;e++)s[e]===s[e+1]&&(s[e]*=2,s[e+1]=0,this.score+=s[e],t=!0);for(s=s.filter(t=>0!==t);s.length<this.state[e].length;)s.push(0);this.state[e].toString()!==s.toString()&&(t=!0,this.state[e]=s)}t&&(this.addCell(),this.checkStatus())}moveRight(){if(this.getStatus()!==e.gameStatus.playing)return;let t=!1;for(let e=0;e<this.state.length;e++){let s=this.state[e].filter(t=>0!==t);for(let e=s.length-1;e>0;e--)s[e]===s[e-1]&&(s[e]*=2,s[e-1]=0,this.score+=s[e],t=!0);for(s=s.filter(t=>0!==t);s.length<this.state[e].length;)s.unshift(0);this.state[e].toString()!==s.toString()&&(t=!0,this.state[e]=s)}t&&(this.addCell(),this.checkStatus())}moveUp(){if(this.getStatus()!==e.gameStatus.playing)return;let t=!1;for(let e=0;e<this.state.length;e++){let s=[];for(let t=0;t<this.state.length;t++)0!==this.state[t][e]&&s.push(this.state[t][e]);for(let e=0;e<s.length-1;e++)s[e]===s[e+1]&&(s[e]*=2,s[e+1]=0,this.score+=s[e],t=!0);for(s=s.filter(t=>0!==t);s.length<this.state.length;)s.push(0);for(let a=0;a<this.state.length;a++)this.state[a][e]!==s[a]&&(this.state[a][e]=s[a],t=!0)}t&&(this.addCell(),this.checkStatus())}moveDown(){if(this.getStatus()!==e.gameStatus.playing)return;let t=!1;for(let e=0;e<this.state.length;e++){let s=[];for(let t=0;t<this.state.length;t++)0!==this.state[t][e]&&s.push(this.state[t][e]);for(let e=s.length-1;e>0;e--)s[e]===s[e-1]&&(s[e]*=2,s[e-1]=0,this.score+=s[e],t=!0);for(s=s.filter(t=>0!==t);s.length<this.state.length;)s.unshift(0);for(let a=0;a<this.state.length;a++)this.state[a][e]!==s[a]&&(this.state[a][e]=s[a],t=!0)}t&&(this.addCell(),this.checkStatus())}getScore(){return this.score}getState(){return this.state}getStatus(){return this.status}start(){this.status=e.gameStatus.playing,this.state=this.initialState.map(t=>[...t]),this.addCell(),this.addCell()}restart(){this.status=e.gameStatus.idle,this.score=0,this.resetState()}getRandomValue(){return .9>Math.random()?2:4}getRandomNumber(t){return Math.floor(Math.random()*t)}checkStatus(){let t=!1,s=!1,a=this.state.length;for(let t=0;t<a;t++)if(this.state[t].includes(2048)){this.status=e.gameStatus.win;return}for(let e=0;e<a;e++){for(let i=0;i<a&&(0===this.state[e][i]&&(t=!0),i<a-1&&this.state[e][i]===this.state[e][i+1]&&(s=!0),e<a-1&&this.state[e][i]===this.state[e+1][i]&&(s=!0),!t&&!s);i++);if(t||s)break}t||s||(this.status=e.gameStatus.lose)}resetState(){this.state=[...this.initialState.map(t=>[...t])]}addCell(){let t=[];for(let e=0;e<this.state.length;e++)for(let s=0;s<this.state[e].length;s++)0===this.state[e][s]&&t.push({rowIndex:e,cellIndex:s});if(0===t.length)return;let e=this.getRandomNumber(t.length),{rowIndex:s,cellIndex:a}=t[e],i=this.state.map(t=>[...t]);i[s][a]=this.getRandomValue(),this.state=i}}const s=new(t=e),a=document.querySelector(".start"),i=document.querySelector(".message-start"),l=document.querySelector(".message-lose"),h=document.querySelector(".message-win"),r=document.querySelector(".game-score");function n(){r.innerHTML=s.getScore()}function o(){let t=document.querySelectorAll(".field-cell"),e=s.state.flat();for(let s=0;s<e.length;s++){let a=t[s],i=e[s];a.classList=["field-cell"],i>0?(a.textContent=i,a.classList.add(`field-cell--${i}`)):a.textContent=""}}a.addEventListener("click",()=>{a.classList.contains("start")?(s.start(),o(),a.classList="button restart",a.innerHTML="Restart",i.classList.add("hidden"),l.classList.add("hidden"),h.classList.add("hidden"),n()):a.classList.contains("restart")&&(s.restart(),o(),a.classList="button start",a.innerHTML="Start",i.classList.remove("hidden"),l.classList.add("hidden"),h.classList.add("hidden"),n())}),document.addEventListener("keyup",e=>{switch(e.key){case"ArrowUp":case"w":s.moveUp(),o();break;case"ArrowDown":case"s":s.moveDown(),o();break;case"ArrowLeft":case"a":s.moveLeft(),o();break;case"ArrowRight":case"d":s.moveRight(),o()}n(),s.getStatus()===t.gameStatus.lose?l.classList.remove("hidden"):s.getStatus()===t.gameStatus.win&&h.classList.remove("hidden")});
//# sourceMappingURL=index.6fe95054.js.map
