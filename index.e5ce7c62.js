!function(){var t,e,a={};function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=Array(e);a<e;a++)n[a]=t[a];return n}function s(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return n(t,void 0);var a=Object.prototype.toString.call(t).slice(8,-1);if("Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a)return Array.from(a);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return n(t,void 0)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var r=function(){var t;function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,e),this.status=e.gameStatus.idle,this.score=0,this.initialState=t,this.state=t.map(function(t){return s(t)})}return t=[{key:"moveLeft",value:function(){var t=this;if(this.getStatus()===e.gameStatus.playing){for(var a=!1,n=0;n<this.state.length;n++)!function(e){for(var n=t.state[e].filter(function(t){return 0!==t}),s=0;s<n.length-1;s++)n[s]===n[s+1]&&(n[s]*=2,n[s+1]=0,t.score+=n[s],a=!0);for(n=n.filter(function(t){return 0!==t});n.length<t.state[e].length;)n.push(0);t.state[e].toString()!==n.toString()&&(a=!0,t.state[e]=n)}(n);a&&(this.addCell(),this.checkStatus())}}},{key:"moveRight",value:function(){var t=this;if(this.getStatus()===e.gameStatus.playing){for(var a=!1,n=0;n<this.state.length;n++)!function(e){for(var n=t.state[e].filter(function(t){return 0!==t}),s=n.length-1;s>0;s--)n[s]===n[s-1]&&(n[s]*=2,n[s-1]=0,t.score+=n[s],a=!0);for(n=n.filter(function(t){return 0!==t});n.length<t.state[e].length;)n.unshift(0);t.state[e].toString()!==n.toString()&&(a=!0,t.state[e]=n)}(n);a&&(this.addCell(),this.checkStatus())}}},{key:"moveUp",value:function(){var t=this;if(this.getStatus()===e.gameStatus.playing){for(var a=!1,n=0;n<this.state.length;n++)!function(e){for(var n=[],s=0;s<t.state.length;s++)0!==t.state[s][e]&&n.push(t.state[s][e]);for(var r=0;r<n.length-1;r++)n[r]===n[r+1]&&(n[r]*=2,n[r+1]=0,t.score+=n[r],a=!0);for(n=n.filter(function(t){return 0!==t});n.length<t.state.length;)n.push(0);for(var i=0;i<t.state.length;i++)t.state[i][e]!==n[i]&&(t.state[i][e]=n[i],a=!0)}(n);a&&(this.addCell(),this.checkStatus())}}},{key:"moveDown",value:function(){var t=this;if(this.getStatus()===e.gameStatus.playing){for(var a=!1,n=0;n<this.state.length;n++)!function(e){for(var n=[],s=0;s<t.state.length;s++)0!==t.state[s][e]&&n.push(t.state[s][e]);for(var r=n.length-1;r>0;r--)n[r]===n[r-1]&&(n[r]*=2,n[r-1]=0,t.score+=n[r],a=!0);for(n=n.filter(function(t){return 0!==t});n.length<t.state.length;)n.unshift(0);for(var i=0;i<t.state.length;i++)t.state[i][e]!==n[i]&&(t.state[i][e]=n[i],a=!0)}(n);a&&(this.addCell(),this.checkStatus())}}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.state}},{key:"getStatus",value:function(){return this.status}},{key:"start",value:function(){this.status=e.gameStatus.playing,this.state=this.initialState.map(function(t){return s(t)}),this.addCell(),this.addCell()}},{key:"restart",value:function(){this.status=e.gameStatus.idle,this.score=0,this.resetState()}},{key:"getRandomValue",value:function(){return .9>Math.random()?2:4}},{key:"getRandomNumber",value:function(t){return Math.floor(Math.random()*t)}},{key:"checkStatus",value:function(){for(var t=!1,a=!1,n=this.state.length,s=0;s<n;s++)if(this.state[s].includes(2048)){this.status=e.gameStatus.win;return}for(var r=0;r<n;r++){for(var i=0;i<n&&(0===this.state[r][i]&&(t=!0),i<n-1&&this.state[r][i]===this.state[r][i+1]&&(a=!0),r<n-1&&this.state[r][i]===this.state[r+1][i]&&(a=!0),!t&&!a);i++);if(t||a)break}t||a||(this.status=e.gameStatus.lose)}},{key:"resetState",value:function(){this.state=s(this.initialState.map(function(t){return s(t)}))}},{key:"addCell",value:function(){for(var t=[],e=0;e<this.state.length;e++)for(var a=0;a<this.state[e].length;a++)0===this.state[e][a]&&t.push({rowIndex:e,cellIndex:a});if(0!==t.length){var n=this.getRandomNumber(t.length),r=t[n],i=r.rowIndex,o=r.cellIndex,u=this.state.map(function(t){return s(t)});u[i][o]=this.getRandomValue(),this.state=u}}}],function(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(e.prototype,t),e}();e={idle:"idle",playing:"playing",win:"win",lose:"lose"},(t="gameStatus")in r?Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[t]=e;var i=new(a=r),o=document.querySelector(".start"),u=document.querySelector(".message-start"),l=document.querySelector(".message-lose"),c=document.querySelector(".message-win"),h=document.querySelector(".game-score");function f(){h.innerHTML=i.getScore()}function d(){for(var t=document.querySelectorAll(".field-cell"),e=i.state.flat(),a=0;a<e.length;a++){var n=t[a],s=e[a];n.classList=["field-cell"],s>0?(n.textContent=s,n.classList.add("field-cell--".concat(s))):n.textContent=""}}o.addEventListener("click",function(){o.classList.contains("start")?(i.start(),d(),o.classList="button restart",o.innerHTML="Restart",u.classList.add("hidden"),l.classList.add("hidden"),c.classList.add("hidden"),f()):o.classList.contains("restart")&&(i.restart(),d(),o.classList="button start",o.innerHTML="Start",u.classList.remove("hidden"),l.classList.add("hidden"),c.classList.add("hidden"),f())}),document.addEventListener("keyup",function(t){switch(t.key){case"ArrowUp":case"w":i.moveUp(),d();break;case"ArrowDown":case"s":i.moveDown(),d();break;case"ArrowLeft":case"a":i.moveLeft(),d();break;case"ArrowRight":case"d":i.moveRight(),d()}f(),i.getStatus()===a.gameStatus.lose?l.classList.remove("hidden"):i.getStatus()===a.gameStatus.win&&c.classList.remove("hidden")})}();
//# sourceMappingURL=index.e5ce7c62.js.map
